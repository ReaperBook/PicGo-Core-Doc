<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API列表 | PicGo-Core</title>
    <meta name="description" content="PicGo核心组件">
    <link rel="icon" href="https://raw.githubusercontent.com/Molunerfinn/test/master/picgo/New%20LOGO-150.png">
    
    <link rel="preload" href="/PicGo-Core-Doc/assets/css/0.styles.c58cb3ae.css" as="style"><link rel="preload" href="/PicGo-Core-Doc/assets/js/app.d9f84169.js" as="script"><link rel="preload" href="/PicGo-Core-Doc/assets/js/5.77c8d8c9.js" as="script"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/10.9f5ff146.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/11.a59e1338.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/12.15ec0510.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/13.33907fef.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/14.e64ffd81.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/2.1a3627a8.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/3.f453878d.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/4.0af0d7b8.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/6.cdcae461.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/7.8b352790.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/8.22f3f940.js"><link rel="prefetch" href="/PicGo-Core-Doc/assets/js/9.b25613b0.js">
    <link rel="stylesheet" href="/PicGo-Core-Doc/assets/css/0.styles.c58cb3ae.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/PicGo-Core-Doc/zh/" class="home-link router-link-active"><!----> <span class="site-name">PicGo-Core</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/PicGo-Core-Doc/zh/guide/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">插件开发指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/PicGo-Core-Doc/zh/dev-guide/cli.html" class="nav-link">插件开发</a></li><li class="dropdown-item"><!----> <a href="/PicGo-Core-Doc/zh/dev-guide/gui.html" class="nav-link">GUI插件开发</a></li><li class="dropdown-item"><!----> <a href="/PicGo-Core-Doc/zh/dev-guide/deploy.html" class="nav-link">插件测试与发布</a></li></ul></div></div><div class="nav-item"><a href="/PicGo-Core-Doc/zh/api/" class="nav-link router-link-exact-active router-link-active">API列表</a></div> <a href="https://github.com/PicGo/PicGo-Core" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/PicGo-Core-Doc/zh/guide/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">插件开发指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/PicGo-Core-Doc/zh/dev-guide/cli.html" class="nav-link">插件开发</a></li><li class="dropdown-item"><!----> <a href="/PicGo-Core-Doc/zh/dev-guide/gui.html" class="nav-link">GUI插件开发</a></li><li class="dropdown-item"><!----> <a href="/PicGo-Core-Doc/zh/dev-guide/deploy.html" class="nav-link">插件测试与发布</a></li></ul></div></div><div class="nav-item"><a href="/PicGo-Core-Doc/zh/api/" class="nav-link router-link-exact-active router-link-active">API列表</a></div> <a href="https://github.com/PicGo/PicGo-Core" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>API列表</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/PicGo-Core-Doc/zh/api/#ctx" class="sidebar-link">ctx</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#upload-input" class="sidebar-link">upload([input])</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#getconfig-name" class="sidebar-link">getConfig([name])</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#setconfig-config" class="sidebar-link">setConfig(config)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#saveconfig-config" class="sidebar-link">saveConfig(config)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#emit-event-message" class="sidebar-link">emit(event, [message])</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#on-event-callback" class="sidebar-link">on(event, [callback])</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#input" class="sidebar-link">input</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#output" class="sidebar-link">output</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#configpath" class="sidebar-link">configPath</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#basedir" class="sidebar-link">baseDir</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#helper" class="sidebar-link">helper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#helper-transformer" class="sidebar-link">helper.transformer</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#helper-uploader" class="sidebar-link">helper.uploader</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#helper-beforetransformplugins" class="sidebar-link">helper.beforeTransformPlugins</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#helper-beforeuploadplugins" class="sidebar-link">helper.beforeUploadPlugins</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#helper-afteruploadplugins" class="sidebar-link">helper.afterUploadPlugins</a></li></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#request-request" class="sidebar-link">Request.request</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#cmd" class="sidebar-link">cmd</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#cmd-program" class="sidebar-link">cmd.program</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#cmd-inquirer" class="sidebar-link">cmd.inquirer</a></li></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#log" class="sidebar-link">log</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#log-info-message" class="sidebar-link">log.info(message)</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#log-warn-message" class="sidebar-link">log.warn(message)</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#log-success-message" class="sidebar-link">log.success(message)</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#log-error-message" class="sidebar-link">log.error(message)</a></li></ul></li><li><a href="/PicGo-Core-Doc/zh/api/#guiapi" class="sidebar-link">guiApi</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#guiapi-showinputbox-option" class="sidebar-link">guiApi.showInputBox([option])</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#showfileexplorer-option" class="sidebar-link">showFileExplorer([option])</a></li><li class="sidebar-sub-header"><a href="/PicGo-Core-Doc/zh/api/#upload-file" class="sidebar-link">upload([file])</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="api列表"><a href="#api列表" aria-hidden="true" class="header-anchor">#</a> API列表</h1> <p>picgo本身是一个流程系统应用。除了最关键的上传之外，picgo还支持配置、log输出、插件、命令行交互等等功能。</p> <h2 id="ctx"><a href="#ctx" aria-hidden="true" class="header-anchor">#</a> ctx</h2> <p>picgo传入插件的<code>ctx</code>其实就是picgo本身。<code>ctx</code>拥有picgo暴露的所有对象和方法。所以picgo本身拥有的方法，你在插件里使用的<code>ctx</code>也具备同样的方法。</p> <p>首先我们来初始化一个picgo实例。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> PicGo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'picgo'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> picgo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PicGo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>接下去介绍picgo的详细API。</p> <h2 id="upload-input"><a href="#upload-input" aria-hidden="true" class="header-anchor">#</a> upload([input])</h2> <p>picgo的上传函数。</p> <ul><li>input: Array&lt;any&gt; || <code>undefined</code></li></ul> <p>upload接收两种情况：</p> <ul><li>空数组或者<code>undefined</code></li></ul> <p>当为空数组或者<code>undefined</code>的时候，picgo将会上传剪贴板里的第一张图片（由于跨平台限制只能为 <strong><code>png</code></strong> 格式）。若剪贴板里不存在图片将会报错。</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>Linux平台需要安装<code>xclip</code></p></div> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// or</span>

picgo<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>非空数组</li></ul> <p>当为非空数组的时候，对应于picgo默认的两种transformer，支持path数组以及base64图片信息数组。参考<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#transformer">Transformer</a>章节。</p> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/xxx/xxx.jpg'</span><span class="token punctuation">,</span> <span class="token string">'/yyy/yyy.png'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="getconfig-name"><a href="#getconfig-name" aria-hidden="true" class="header-anchor">#</a> getConfig([name])</h2> <p>获取picgo的config信息。</p> <ul><li>name: string</li></ul> <p>默认的配置长这样：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;picBed&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;current&quot;</span><span class="token operator">:</span> <span class="token string">&quot;smms&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你可以通过<code>getConfig()</code>获取完整信息：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>输出：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;picBed&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;current&quot;</span><span class="token operator">:</span> <span class="token string">&quot;smms&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>...<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>或者你可以选择你要查看的具体配置项：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span><span class="token string">'picBed.current'</span><span class="token punctuation">)</span> <span class="token comment">// 支持多级查找</span>
</code></pre></div><p>输出：<code>smms</code>。</p> <h2 id="setconfig-config"><a href="#setconfig-config" aria-hidden="true" class="header-anchor">#</a> setConfig(config)</h2> <p>配置picgo的config但不写入配置文件，用于上下文临时使用。</p> <ul><li>config: object</li></ul> <p>需要传入一个合法的对象去配置picgo的config信息。 <strong>这个方法不会写入配置文件</strong> ，一次流程执行结束后不会改变配置文件本身，却可以在流程过程中实现后续部件读取的配置。</p> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'picBed.current'</span><span class="token punctuation">:</span> <span class="token string">'gitlab'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="saveconfig-config"><a href="#saveconfig-config" aria-hidden="true" class="header-anchor">#</a> saveConfig(config)</h2> <p>配置picgo的config并写入配置文件，用于持久化保存配置。</p> <ul><li>config: object</li></ul> <p>需要传入一个合法的对象去配置picgo的config信息。<strong>这个方法会写入配置文件</strong>，并影响之后每次picgo读取的配置文件。</p> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">saveConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'picgo-plugin-test'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    xxx<span class="token punctuation">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
    yyy<span class="token punctuation">:</span> <span class="token string">'yyy'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="emit-event-message"><a href="#emit-event-message" aria-hidden="true" class="header-anchor">#</a> emit(event, [message])</h2> <p>事件派发。继承于EventEmmitter。</p> <ul><li>event: string</li> <li>message: any</li></ul> <p>通过<code>emit</code>可以派发事件，再通过<code>on</code>方法监听。</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>一个特殊的事件名是<code>notification</code>，picgo以及一些插件将会使用这个事件名，详情可以查看<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#消息通知">消息通知</a>章节。</p></div> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token punctuation">:</span> <span class="token string">'xxx'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="on-event-callback"><a href="#on-event-callback" aria-hidden="true" class="header-anchor">#</a> on(event, [callback])</h2> <p>事件监听。继承于EventEmmitter。</p> <ul><li>event: string</li> <li>callback: function</li></ul> <p>通过<code>on</code>可以监听<code>emit</code>派发的事件。picgo自带的事件可以参考<a href="/PicGo-Core-Doc/zh/guide/use-in-node.html#事件监听">事件监听</a>一章。</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span> message <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token comment">// { message: 'xxx' }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="input"><a href="#input" aria-hidden="true" class="header-anchor">#</a> input</h2> <ul><li>type: Array&lt;any&gt;</li></ul> <p>picgo的输入。是一个数组。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>picgo<span class="token punctuation">.</span>input<span class="token punctuation">)</span>
</code></pre></div><h2 id="output"><a href="#output" aria-hidden="true" class="header-anchor">#</a> output</h2> <ul><li>type: Array&lt;any&gt;</li></ul> <p>picgo的输出。是一个数组。通常上传成功之后要给这个数组里每一项加入<code>imgUrl</code>以及<code>url</code>项。可以参考picgo默认的<a href="https://github.com/PicGo/PicGo-Core/blob/dev/src/plugins/uploader/smms.ts#L25-L37" target="_blank" rel="noopener noreferrer">smms<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Uploader。</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>input通过Transformer之后就会进入output数组中，而不是经过Uploader才会变成output。</p></div> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>picgo<span class="token punctuation">.</span>output<span class="token punctuation">)</span>
</code></pre></div><h2 id="configpath"><a href="#configpath" aria-hidden="true" class="header-anchor">#</a> configPath</h2> <ul><li>type: string</li></ul> <p>picgo的config所在路径。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>picgo<span class="token punctuation">.</span>configPath<span class="token punctuation">)</span>
</code></pre></div><h2 id="basedir"><a href="#basedir" aria-hidden="true" class="header-anchor">#</a> baseDir</h2> <ul><li>type: string</li></ul> <p>picgo的config文件所在的文件夹路径。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>picgo<span class="token punctuation">.</span>baseDir<span class="token punctuation">)</span>
</code></pre></div><h2 id="helper"><a href="#helper" aria-hidden="true" class="header-anchor">#</a> helper</h2> <p>helper是picgo的主要插件的集中管理者，包含5个部件，拥有相同的api，不过所在生命周期不同，详情可见<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html">生命周期流程</a>。因此只介绍<code>helper.transformer</code>即可。</p> <h3 id="helper-transformer"><a href="#helper-transformer" aria-hidden="true" class="header-anchor">#</a> helper.transformer</h3> <h4 id="register-id-plugin"><a href="#register-id-plugin" aria-hidden="true" class="header-anchor">#</a> register(id, plugin)</h4> <ul><li>id: string</li> <li>plugin: object</li></ul> <p>如果你只是要开发一个简单的插件，而不是发布一个npm包的话（发布picgo的npm插件包请查看<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html">插件开发指南</a>），那么只需要调用<code>helper[module].register</code>方法即可。</p> <p>第一个参数代表插件的id（相同的部件只能拥有唯一的id，不过不同的部件可以拥有相同的id），第二个参数应当是一个对象，至少包括一个<code>handle</code>方法供picgo调用。如果你还想要拥有<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#配置项的处理">配置项</a>功能，可以考虑再加入<code>config</code>方法供picgo调用。</p> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>helper<span class="token punctuation">.</span>transformer<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">handle</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ctx
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">config</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="helper-uploader"><a href="#helper-uploader" aria-hidden="true" class="header-anchor">#</a> helper.uploader</h3> <p>同上。</p> <h3 id="helper-beforetransformplugins"><a href="#helper-beforetransformplugins" aria-hidden="true" class="header-anchor">#</a> helper.beforeTransformPlugins</h3> <p>同上，不过不拥有配置项功能。</p> <h3 id="helper-beforeuploadplugins"><a href="#helper-beforeuploadplugins" aria-hidden="true" class="header-anchor">#</a> helper.beforeUploadPlugins</h3> <p>同上，不过不拥有配置项功能。</p> <h3 id="helper-afteruploadplugins"><a href="#helper-afteruploadplugins" aria-hidden="true" class="header-anchor">#</a> helper.afterUploadPlugins</h3> <p>同上，不过不拥有配置项功能。</p> <h2 id="request-request"><a href="#request-request" aria-hidden="true" class="header-anchor">#</a> Request.request</h2> <p>Request.request是picgo内部暴露的一个<a href="https://github.com/request/request-promise-native" target="_blank" rel="noopener noreferrer">Request-Promise-Native<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>对象，拥有一个可以使用<a href="https://github.com/request/request" target="_blank" rel="noopener noreferrer">request<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>库里的所有方法，并且返回的是原生的Promise。</p> <div class="tip custom-block"><p class="custom-block-title">小贴士</p> <p>值得注意的是，使用这个对象来发送请求的话，能自动读取用户配置给picgo的 <code>proxy</code> 值。比较适合用于书写Uploder的核心部分。</p></div> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  uri<span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">,</span>
  body<span class="token punctuation">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'yyy'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="cmd"><a href="#cmd" aria-hidden="true" class="header-anchor">#</a> cmd</h2> <p>用于提供picgo的命令行程序。</p> <h3 id="cmd-program"><a href="#cmd-program" aria-hidden="true" class="header-anchor">#</a> cmd.program</h3> <p>用于注册CLI命令。实际上是一个<a href="https://github.com/tj/commander.js/" target="_blank" rel="noopener noreferrer">commander.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的实例，用法和<code>commander.js</code>几乎一致。 <strong>不过请不要手动调用picgo.cmd.program.parse(process.argv)否则会导致出错</strong> 。参考<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#注册cli命令">注册命令</a>一章。</p> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>cmd<span class="token punctuation">.</span>program
  <span class="token punctuation">.</span><span class="token function">commands</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token string">'This is a test commands'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="cmd-inquirer"><a href="#cmd-inquirer" aria-hidden="true" class="header-anchor">#</a> cmd.inquirer</h3> <p>用于提供CLI命令行交互。实际上是一个<a href="https://github.com/SBoudrias/Inquirer.js/" target="_blank" rel="noopener noreferrer">inquirer.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的实例，用法和<code>inquirer.js</code>一致。参考<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#配置项的处理">配置项的处理</a>一章。通常PicGo内部会将其和插件的<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#config方法">config</a>方法一起使用。</p> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> handleConfig <span class="token operator">=</span> <span class="token keyword">async</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prompts <span class="token operator">=</span> <span class="token function">config</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
  <span class="token keyword">const</span> answer <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>cmd<span class="token punctuation">.</span>inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>prompts<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">saveConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 调用saveConfig保存配置</span>
    <span class="token string">'picBed.xxx'</span><span class="token punctuation">:</span> answer
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>你可以通过这个工具来制作你自己的命令行交互。不过需要注意的是，通常你应该直接使用插件的<a href="/PicGo-Core-Doc/zh/dev-guide/cli.html#config方法">config</a>方法来实现命令行交互，并且PicGo会自动存储<code>config</code>相关配置项的结果。</p></div> <h2 id="log"><a href="#log" aria-hidden="true" class="header-anchor">#</a> log</h2> <p>用于在命令行输出漂亮的信息，给予用户提示。</p> <p>截图：</p> <p><img src="https://raw.githubusercontent.com/Molunerfinn/test/master/picgo/20180912153940.png" alt></p> <h3 id="log-info-message"><a href="#log-info-message" aria-hidden="true" class="header-anchor">#</a> log.info(message)</h3> <ul><li>message: string</li></ul> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="log-warn-message"><a href="#log-warn-message" aria-hidden="true" class="header-anchor">#</a> log.warn(message)</h3> <ul><li>message: string</li></ul> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="log-success-message"><a href="#log-success-message" aria-hidden="true" class="header-anchor">#</a> log.success(message)</h3> <ul><li>message: string</li></ul> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="log-error-message"><a href="#log-error-message" aria-hidden="true" class="header-anchor">#</a> log.error(message)</h3> <ul><li>message: string | error</li></ul> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>picgo<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="guiapi"><a href="#guiapi" aria-hidden="true" class="header-anchor">#</a> guiApi</h2> <p><strong>guiApi仅在electron版本的PicGo里提供，详细信息可以参考<a href="/PicGo-Core-Doc/zh/dev-guide/gui.html">GUI插件开发一章</a>。</strong></p> <h3 id="guiapi-showinputbox-option"><a href="#guiapi-showinputbox-option" aria-hidden="true" class="header-anchor">#</a> guiApi.showInputBox([option])</h3> <p>调用之后打开一个输入弹窗，可以用于接受用户输入。</p> <ul><li>option: Object || <code>undefined</code></li> <li>return: 返回一个Promise对象，resolve的值是用户输入的结果。</li></ul> <p>其中option是可选值，可以传入一个<code>{title, placeholder}</code>的对象，用于弹窗的标题和输入框的<code>placeholder</code>显示。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">guiMenu</span> <span class="token operator">=</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      label<span class="token punctuation">:</span> <span class="token string">'打开InputBox'</span><span class="token punctuation">,</span>
      <span class="token keyword">async</span> <span class="token function">handle</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> guiApi<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">await</span> guiApi<span class="token punctuation">.</span><span class="token function">showInputBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token punctuation">:</span> <span class="token string">'打开对话框'</span><span class="token punctuation">,</span>
          placeholder<span class="token punctuation">:</span> <span class="token string">'请输入文件地址'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="showfileexplorer-option"><a href="#showfileexplorer-option" aria-hidden="true" class="header-anchor">#</a> showFileExplorer([option])</h3> <p>调用之后打开一个文件浏览器，可以得到用户选择的文件（夹）路径。</p> <ul><li>option: Object || <code>undefined</code></li> <li>return: 返回一个Promise对象，resolve的值是用户选择的文件路径数组。</li></ul> <p>其中option是可选值，可以传入一个合法的electron的dialog的<a href="https://electronjs.org/docs/api/dialog#dialogshowopendialogbrowserwindow-options-callback" target="_blank" rel="noopener noreferrer">options对象<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，用于指定是否可多选，用于选择文件还是文件夹等等。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">guiMenu</span> <span class="token operator">=</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      label<span class="token punctuation">:</span> <span class="token string">'打开文件浏览器'</span><span class="token punctuation">,</span>
      <span class="token keyword">async</span> <span class="token function">handle</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> guiApi<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token keyword">await</span> guiApi<span class="token punctuation">.</span><span class="token function">showFileExplorer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          properties<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'openFile'</span><span class="token punctuation">,</span> <span class="token string">'multiSelections'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="upload-file"><a href="#upload-file" aria-hidden="true" class="header-anchor">#</a> upload([file])</h3> <p>调用之后使用PicGo底层来上传，可以实现自动更新相册图片、上传成功后自动将URL写入剪贴板。</p> <ul><li>file: Array || <code>undefined</code></li> <li>return: 返回一个Promise对象，resolve的值是PicGo上传成功后的output值，是一个数组。</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/PicGo/PicGo-Core-Doc/edit/master/docs/zh/api/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/PicGo-Core-Doc/assets/js/app.d9f84169.js" defer></script><script src="/PicGo-Core-Doc/assets/js/5.77c8d8c9.js" defer></script>
  </body>
</html>
